@isTest
public class ReporteAtnController_Test {
    static testMethod void validar(){
        User usuar = [SELECT Id FROM User WHERE Name LIKE 'Admin J%' LIMIT 1];
        List<Casos_Residente__c> casolist =  new list<Casos_Residente__c>();
        // cuenta.ReferenciaBancariaCliente__c = 'PRUEBA';
        //cuenta.Name = cuenta.Nombre_cta__c + ' ' + cuenta.Apellidopaterno_cta__c + ' ' + cuenta.Apellidomaterno_cta__c;
        Account acc = new Account();
        acc.FirstName= 'Lopez';
        acc.LastName= 'test';
        acc.RecordTypeId =Schema.sObjectType.Account.getRecordTypeInfosBydevelopername().get('Prospecto_Persona_Fisica').getRecordTypeId();
        acc.CorreoElectronico__c = 'test@prospects.com';
        acc.Apellidomaterno_cta__c = 'dahuoh';
        acc.PersonBirthdate=date.today().addyears(-20);
        acc.Phone = '+528119928819';
        acc.Otro_Telefono__c = '+528119928819';
        acc.TelefonoCelular__c='+525530303030'; 
        acc.Canal_de_Venta__c = 'PROSPECTO ASESOR';
        acc.Notaria__c = 'PRUEBA';
        acc.Notario__c = 'PRUEBA';
        acc.isATC__c = true;
        acc.Numerodecliente__c = 'AA';
        acc.Nombre_cta__c = 'PRUEBA';
        acc.Estatus_Lista_Negra_QEQ__c = 'VALIDADO';
        insert acc;
        Inventario__c inventario = new Inventario__c();
        inventario.Condominio__c = 'Condominio';
        inventario.Name = 'AABBCCDDEE-Prueba';
        inventario.Entregada__c = 'Por Entregar';
        inventario.FechaHabitabilidad__c = System.today().format();
        inventario.PorcentajeCheckList__c = 0;
        inventario.FechadeHabitabilidad__c = System.today();
        inventario.Cuenta__c = acc.Id;
        inventario.Revisiones_en_Vivienda__c = '3';
        insert inventario;
        Casos_Residente__c caso = new Casos_Residente__c();
        caso.Detalledelreporte__c = 'asdasd';
        caso.Cuenta__c = acc.Id;
        caso.ViviendaProceso__c = inventario.Id;
        caso.ContactEmail__c='correo@prueba.com';
        caso.ContactMobile__c='88888888';
        caso.OwnerId = usuar.Id;
        caso.Origendegarantia__c = 'Producto';
        caso.Fecha_Cierre_Cancelacion__c = system.today()-1;
        insert caso;
        casolist.add(caso);
        Visita__c v1 = new Visita__c();
        v1.Fechaprogramadadevisita__c = System.today()+1;
        v1.Horaprogramadadevisita__c = time.newInstance(15, 0, 0, 0);
        v1.Horafindevisita__c = time.newInstance(17, 0, 0, 0);        
        v1.OwnerID = usuar.Id;
        v1.CasoResidente__c = caso.Id;
        v1.Inventario__c = inventario.Id;
        insert v1;
        Conjunto_Casos__c cc = new Conjunto_Casos__c();
        insert cc;
        
        Casos_Residente__c caso1 = new Casos_Residente__c();
        caso1.Detalledelreporte__c = 'asdasd';
        caso1.Cuenta__c = acc.Id;
        caso1.ViviendaProceso__c = inventario.Id;
        caso1.ContactEmail__c='correo@prueba.com';
        caso1.ContactMobile__c='88888888';
        caso1.OwnerId = usuar.Id;
        caso1.Origendegarantia__c = 'Producto';
        caso1.Conjunto_Casos__c = cc.Id;
        caso1.Fecha_Cierre_Cancelacion__c = system.today()-1;
        caso1.Status__c = 'Cancelado';
        insert caso1;
        casolist.add(caso1);
        Conjunto_Visitas__c conjunto = new Conjunto_Visitas__c();
        conjunto.Caso_ATC__c = caso.Id;
        conjunto.Cita_Visita__c = v1.Id;
        conjunto.Proceso_ATC__c = v1.Inventario__c;
        insert conjunto;
        Conjunto_Visitas__c conjunto1 = new Conjunto_Visitas__c();
        conjunto1.Caso_ATC__c = caso1.Id;
        conjunto1.Cita_Visita__c = v1.Id;
        conjunto1.Proceso_ATC__c = v1.Inventario__c;
        insert conjunto1;
        Test.startTest();
        PageReference page = Page.AtnCliente_Reporte;
        page.getParameters().put('id',caso.Id);
        Test.setCurrentPageReference(page);
        ReporteAtnController ctr = new ReporteAtnController();
        ctr.listCasos = casolist;
        ctr.caso = caso;
        ctr.conjunto = cc;
        ctr.prepare();
        ctr.vivienda  = inventario;
        ctr.propietario = usuar;
        ctr.residente = acc;
        ctr.f = '10';
        ctr.a = '2';
        ctr.d = '3';
        ctr.filename =  'test';
        ctr.fv = '5';
        ctr.m = '8';
        Test.stopTest();
    }
}